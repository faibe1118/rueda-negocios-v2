<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Panel del Administrador del Sistema</title>
</head>

<body>
    <h1>Panel - Administrador del Sistema</h1>

    <p>
        Bienvenido, aqu√≠ puedes gestionar los m√≥dulos principales del sistema.
    </p>

    <button onclick="irGestionUsuarios()">üë• Gesti√≥n de Usuarios</button>
    <br /><br />

    <button onclick="irGestionPublicaciones()">
        üì∞ Gesti√≥n de Publicaciones
    </button>
    <br /><br />

    <button onclick="generarMatches()">
        ‚ö° Generar Matches Autom√°ticos
    </button>
    <br /><br />

    <button onclick="cerrarSesion()">üîê Cerrar sesi√≥n</button>

    <script>
        // Validar que el admin haya iniciado sesi√≥n
        const token = localStorage.getItem("token");
        const role = localStorage.getItem("userRole");

        if (!token || role !== "adminSistema") {
            alert("Acceso no autorizado");
            window.location.href = "./login.html";
        }

        function irGestionUsuarios() {
            window.location.href = "./gestion-usuarios.html";
        }

        function irGestionPublicaciones() {
            window.location.href = "./gestion-publicaciones.html";
        }

        async function generarMatches() {
            if (!confirm("¬øDeseas ejecutar el algoritmo de emparejamiento?")) return;

            try {
                const response = await fetch("http://localhost:4000/api/matches/generate", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${token}` }
                });
                const data = await response.json();
                alert(data.message);
            } catch (e) {
                alert("Error generando matches");
                console.error(e);
            }
        }

        function cerrarSesion() {
            localStorage.clear();
            window.location.href = "./login.html";
        }
    </script>
</body>

</html>