<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Mi Agenda - Rueda de Negocios</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <h1>üìÖ Mi Agenda de Reuniones</h1>
    <a href="profile.html">‚¨Ö Volver al Perfil</a> | <a href="matches.html">ü§ù Ver Matches</a>
    <hr>

    <table id="agenda-table">
        <thead>
            <tr>
                <th>Fecha</th>
                <th>Hora Inicio</th>
                <th>Hora Fin</th>
                <th>Empresa</th>
                <th>Lugar</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            <!-- Se llena din√°micamente -->
        </tbody>
    </table>

    <script src="../js/services/meetingService.js"></script>
    <script>
        async function cargarAgenda() {
            const tbody = document.querySelector("#agenda-table tbody");
            const meetings = await meetingService.getSchedule();

            if (meetings.length === 0) {
                tbody.innerHTML = "<tr><td colspan='6'>No tienes reuniones programadas.</td></tr>";
                return;
            }

            tbody.innerHTML = "";
            meetings.forEach(m => {
                const start = new Date(m.startTime);
                const end = new Date(m.endTime);

                // Mostrar la otra empresa (no la m√≠a)
                // Esto es un poco truco en el frontend simple, mostramos ambas para asegurar
                const empresas = `${m.matchId.supplierId.nombreEmpresa} y ${m.matchId.buyerId.nombreEmpresa}`;

                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${start.toLocaleDateString()}</td>
                    <td>${start.toLocaleTimeString()}</td>
                    <td>${end.toLocaleTimeString()}</td>
                    <td>${empresas}</td>
                    <td>${m.location}</td>
                    <td>${m.status}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        cargarAgenda();
    </script>
</body>

</html>